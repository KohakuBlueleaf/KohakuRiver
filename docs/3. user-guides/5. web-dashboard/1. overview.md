# Web Dashboard Guide

Optional web interface for visual cluster management.

---

## Setup

### Development

```bash
cd src/kohakuriver-manager
npm install
npm run dev
```

Access: `http://localhost:5173` (proxies `/api` to Host at `localhost:8000`)

### Production

```bash
npm run build
# Serve dist/ with web server, proxy /api/ to Host with WebSocket support
```

**Nginx config:**

```nginx
server {
    listen 80;
    root /var/www/kohakuriver;
    location / { try_files $uri $uri/ /index.html; }
    location /api/ {
        proxy_pass http://localhost:8000/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
    location /ws/ {
        proxy_pass http://localhost:8000/ws/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

---

## Views

| View | Features |
|------|----------|
| **Home** | Node summary, resource utilization, task counts |
| **Nodes** | Status, cores, memory, NUMA topology per node |
| **GPUs** | GPU utilization, temperature, memory per device |
| **Tasks** | Command task list, submission form, log viewer, web terminal |
| **VPS** | VPS list, submission form, connection info, web terminal |
| **Docker** | Host containers, tarballs, interactive shell |

---

## Task Submission Forms

**Command Tasks:** Command, args, target (node/NUMA/GPU), cores, memory, container, mounts, privileged

**VPS Tasks:** SSH public key, target, cores, memory, container

---

## Interactive Features

### Web Terminal

Access running tasks and VPS directly from the browser:
- Click terminal button on any running task/VPS
- Full TTY support (vim, htop work)
- No Docker port mapping required

### Live Monitoring

- Real-time view updates
- Live log streaming for running tasks
- Task search and filtering

### Port Forwarding Info

For VPS and tasks, the dashboard shows connection commands:
```bash
# Copy from dashboard
kohakuriver connect <task_id>
kohakuriver forward <task_id> <port>
```

---

## Terminal TUI Alternative

For terminal-only environments, use the CLI dashboard:

```bash
kohakuriver terminal
```

Provides similar functionality with keyboard navigation.

---

## Troubleshooting

| Issue | Solution |
|-------|----------|
| API connection fails | Check Host running, proxy config |
| WebSocket errors | Verify proxy upgrade headers, check `/ws/` route |
| Shell not working | Check WebSocket proxy for `/ws/task/` and `/ws/forward/` |
| Terminal not responding | Verify container is running, check Host logs |
